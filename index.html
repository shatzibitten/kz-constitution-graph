<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤: –ü—Ä–æ–µ–∫—Ç –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.js.iife.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css"/>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        
        .header {
            padding: 30px 40px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 600;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #888;
            font-size: 14px;
        }
        
        .container {
            display: flex;
            height: calc(100vh - 100px);
        }
        
        .sidebar {
            width: 380px;
            background: rgba(0, 0, 0, 0.4);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            padding: 20px;
        }
        
        .legend {
            margin-bottom: 30px;
        }
        
        .legend h3 {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 13px;
        }
        
        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .legend-line {
            width: 30px;
            height: 3px;
            margin-right: 12px;
            flex-shrink: 0;
            border-radius: 2px;
        }
        
        .node-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .node-info:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(102, 126, 234, 0.3);
        }
        
        .node-info h4 {
            font-size: 15px;
            color: #fff;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .node-info h4 .badge {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 10px;
            margin-left: 10px;
            font-weight: 500;
        }
        
        .node-info p {
            font-size: 12px;
            color: #888;
            line-height: 1.6;
        }
        
        .graph-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        #graph {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(20, 20, 35, 0.95);
            border: 1px solid rgba(102, 126, 234, 0.5);
            border-radius: 10px;
            padding: 15px 18px;
            font-size: 13px;
            max-width: 320px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .tooltip h5 {
            color: #667eea;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .tooltip p {
            color: #ccc;
            line-height: 1.5;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 50;
        }
        
        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: #667eea;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn:hover {
            background: rgba(102, 126, 234, 0.4);
            transform: scale(1.05);
        }
        
        /* Node styling */
        .node circle {
            stroke-width: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .node:hover circle {
            filter: brightness(1.3);
            stroke-width: 4px;
        }
        
        .node text {
            font-size: 11px;
            fill: #fff;
            font-weight: 500;
            pointer-events: none;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        }
        
        .link {
            fill: none;
            stroke-opacity: 0.6;
            transition: all 0.3s ease;
        }
        
        .link:hover {
            stroke-opacity: 1;
            stroke-width: 4px !important;
        }
        
        .link-label {
            font-size: 9px;
            fill: #aaa;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .link-label.visible {
            opacity: 1;
        }
        
        .link-label-item {
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .link-label-item.visible {
            opacity: 1;
        }
        
        .link-label-bg {
            fill: rgba(15, 15, 26, 0.9);
        }
        
        .link-label-item .link-label {
            opacity: 1;
        }
        
        /* Category colors */
        .president { fill: #ef4444; stroke: #dc2626; }
        .parliament { fill: #3b82f6; stroke: #2563eb; }
        .government { fill: #f59e0b; stroke: #d97706; }
        .judiciary { fill: #8b5cf6; stroke: #7c3aed; }
        .rights { fill: #10b981; stroke: #059669; }
        .local { fill: #ec4899; stroke: #db2777; }
        .international { fill: #06b6d4; stroke: #0891b2; }
        
        /* Edge colors */
        .edge-collision { stroke: #ef4444; }
        .edge-lever { stroke: #f59e0b; }
        .edge-cooling { stroke: #3b82f6; }
        .edge-dependency { stroke: #6b7280; }
        
        .stats-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stats-panel h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #667eea;
            margin-bottom: 12px;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .stat-value {
            color: #fff;
            font-weight: 600;
        }

        .filter-section {
            margin-bottom: 25px;
        }
        
        .filter-section h3 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #667eea;
            margin-bottom: 12px;
        }
        
        .filter-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: #ccc;
            font-size: 11px;
            cursor: pointer;
            margin: 3px;
            transition: all 0.2s ease;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.5);
            color: #fff;
        }

        /* Animated gradient background for header */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Highlights Panel */
        .highlights-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 520px;
            height: 100vh;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            transform: translateX(calc(100% - 50px));
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 100;
            display: flex;
        }
        
        .highlights-panel.open {
            transform: translateX(0);
        }
        
        .highlights-toggle {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translate(-100%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px 0 0 12px;
            padding: 15px 12px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: white;
            box-shadow: -4px 0 20px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
        }
        
        .highlights-toggle:hover {
            padding-left: 18px;
            box-shadow: -6px 0 30px rgba(102, 126, 234, 0.5);
        }
        
        .toggle-icon {
            font-size: 20px;
        }
        
        .toggle-text {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .toggle-arrow {
            font-size: 10px;
            transition: transform 0.3s ease;
        }
        
        .highlights-panel.open .toggle-arrow {
            transform: rotate(180deg);
        }
        
        .highlights-content {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            padding-left: 20px;
        }
        
        .highlights-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .highlights-header h2 {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
        }
        
        .highlights-subtitle {
            color: #888;
            font-size: 13px;
        }
        
        .highlight-section {
            margin-bottom: 35px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }
        
        .section-icon {
            font-size: 22px;
        }
        
        .section-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
            margin: 0;
        }
        
        .section-badge {
            font-size: 10px;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .collision-badge {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .lever-badge {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .cooling-badge {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .rec-badge {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .highlight-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 14px;
            display: flex;
            gap: 15px;
            transition: all 0.3s ease;
        }
        
        .highlight-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateX(-3px);
        }
        
        .highlight-card.clickable {
            cursor: pointer;
        }
        
        .highlight-card.clickable::after {
            content: "üëÅ –ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –≥—Ä–∞—Ñ–µ";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 10px;
            color: #667eea;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        .highlight-card.clickable:hover::after {
            opacity: 1;
        }
        
        .highlight-card.clickable {
            position: relative;
        }
        
        .highlight-card.active {
            background: rgba(102, 126, 234, 0.15) !important;
            border-color: rgba(102, 126, 234, 0.5) !important;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }
        
        /* Highlighted nodes in graph */
        .node.highlighted circle {
            filter: brightness(1.5) drop-shadow(0 0 10px currentColor);
            stroke-width: 4px !important;
        }
        
        .node.dimmed {
            opacity: 0.2;
        }
        
        .link.dimmed {
            opacity: 0.1 !important;
        }
        
        .link.highlighted {
            stroke-opacity: 1 !important;
            stroke-width: 4px !important;
        }
        
        .collision-section .highlight-card {
            border-left: 3px solid #ef4444;
        }
        
        .lever-section .highlight-card {
            border-left: 3px solid #f59e0b;
        }
        
        .cooling-section .highlight-card {
            border-left: 3px solid #3b82f6;
        }
        
        .card-number {
            width: 28px;
            height: 28px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
            color: #fff;
            flex-shrink: 0;
        }
        
        .card-content {
            flex: 1;
        }
        
        .card-content h4 {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .card-content p {
            font-size: 12px;
            color: #aaa;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .card-content p strong {
            color: #ddd;
        }
        
        .card-content ul {
            margin: 8px 0;
            padding-left: 18px;
        }
        
        .card-content li {
            font-size: 12px;
            color: #aaa;
            line-height: 1.6;
            margin-bottom: 4px;
        }
        
        .card-impact {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px !important;
        }
        
        .collision-section .card-impact {
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        .lever-section .card-impact {
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .cooling-section .card-impact {
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        /* Recommendations */
        .rec-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .rec-item {
            display: flex;
            gap: 12px;
            padding: 14px;
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.15);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .rec-item:hover {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .rec-number {
            width: 24px;
            height: 24px;
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .rec-content {
            font-size: 12px;
            color: #ccc;
            line-height: 1.6;
        }
        
        .rec-content strong {
            color: #10b981;
        }
        
        /* Scrollbar for highlights */
        .highlights-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .highlights-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .highlights-content::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 3px;
        }
        
        .highlights-content::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.5);
        }
        
        /* ============================================
           MOBILE STYLES
           ============================================ */
        
        /* Mobile bottom navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 15, 26, 0.98);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            padding-bottom: calc(8px + env(safe-area-inset-bottom));
            z-index: 200;
            backdrop-filter: blur(10px);
        }
        
        .mobile-nav-tabs {
            display: flex;
            gap: 8px;
        }
        
        .mobile-nav-tab {
            flex: 1;
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: #888;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
        }
        
        .mobile-nav-tab.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-color: rgba(102, 126, 234, 0.5);
            color: #fff;
        }
        
        .mobile-nav-tab-icon {
            font-size: 16px;
        }
        
        /* Mobile sidebar toggle - hidden, use bottom nav instead */
        .mobile-sidebar-toggle {
            display: none;
        }
        
        @media (max-width: 900px) {
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .header p {
                font-size: 12px;
            }
            
            .container {
                height: calc(100vh - 80px - 70px);
            }
            
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                height: 100vh;
                width: 320px;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 150;
                padding-top: 80px;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .mobile-nav {
                display: block;
            }
            
            .graph-container {
                width: 100%;
            }
            
            .controls {
                top: auto;
                bottom: 90px;
                left: 10px;
                right: auto;
                flex-direction: column;
            }
            
            .control-btn {
                width: 44px;
                height: 44px;
                font-size: 20px;
            }
            
            /* Fix touch events on graph */
            #graph {
                touch-action: none;
            }
            
            /* Highlights panel - fullscreen on mobile */
            .highlights-panel {
                width: 100%;
                transform: translateY(100%);
                top: auto;
                bottom: 0;
                height: calc(100vh - 70px);
                border-left: none;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 20px 20px 0 0;
            }
            
            .highlights-panel.open {
                transform: translateY(0);
            }
            
            .highlights-toggle {
                display: none;
            }
            
            .highlights-content {
                padding: 20px;
                padding-bottom: 100px;
            }
            
            .highlights-header {
                margin-bottom: 20px;
            }
            
            .highlights-header h2 {
                font-size: 20px;
            }
            
            .highlight-card {
                padding: 14px;
            }
            
            .highlight-card.clickable::after {
                display: none;
            }
            
            .card-content h4 {
                font-size: 13px;
            }
            
            .card-content p,
            .card-content li {
                font-size: 12px;
            }
            
            /* Mobile overlay when sidebar is open */
            .mobile-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 140;
            }
            
            .mobile-overlay.visible {
                display: block;
            }
            
            /* Larger touch targets for nodes */
            .node circle {
                r: 26;
            }
            
            .node text {
                font-size: 10px;
            }
            
            /* Better tooltip for mobile - fixed at bottom */
            .tooltip {
                max-width: calc(100vw - 40px);
                font-size: 12px;
                left: 50% !important;
                top: auto !important;
                bottom: 80px;
                transform: translateX(-50%);
                position: fixed;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 16px;
            }
            
            .container {
                height: calc(100vh - 70px - 65px);
            }
            
            .sidebar {
                width: 100%;
            }
            
            .controls {
                top: 70px;
                right: 8px;
                gap: 6px;
            }
            
            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .mobile-nav-tab {
                padding: 10px 12px;
                font-size: 12px;
            }
            
            .highlights-header h2 {
                font-size: 18px;
            }
            
            .section-header h3 {
                font-size: 14px;
            }
            
            .highlight-card {
                padding: 12px;
                gap: 10px;
            }
            
            .card-number {
                width: 24px;
                height: 24px;
                font-size: 11px;
            }
            
            .rec-item {
                padding: 12px;
            }
        }
        
        /* Touch-friendly: prevent text selection on interactive elements */
        .mobile-nav-tab,
        .control-btn,
        .highlight-card.clickable,
        .filter-btn {
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Pull indicator for mobile highlights panel */
        .mobile-pull-indicator {
            display: none;
            width: 40px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin: 0 auto 15px;
        }
        
        @media (max-width: 900px) {
            .mobile-pull-indicator {
                display: block;
            }
        }
        
        /* ============================================
           WELCOME MODAL & ONBOARDING
           ============================================ */
        
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .welcome-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .welcome-modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
        }
        
        .welcome-header {
            padding: 30px 30px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .welcome-header h2 {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        
        .welcome-header p {
            color: #888;
            font-size: 14px;
        }
        
        .welcome-body {
            padding: 25px 30px;
        }
        
        .disclaimer-box {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 25px;
            max-height: 180px;
            overflow-y: auto;
        }
        
        .disclaimer-box p {
            font-size: 12px;
            color: #aaa;
            line-height: 1.7;
            text-align: justify;
        }
        
        .disclaimer-box::-webkit-scrollbar {
            width: 4px;
        }
        
        .disclaimer-box::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .disclaimer-box::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 2px;
        }
        
        .tour-preview {
            text-align: center;
            padding: 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            border: 1px dashed rgba(102, 126, 234, 0.3);
        }
        
        .tour-preview p {
            font-size: 14px;
            color: #aaa;
        }
        
        /* Driver.js customization for dark theme */
        .driver-popover {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%) !important;
            border: 1px solid rgba(102, 126, 234, 0.4) !important;
            color: #e0e0e0 !important;
        }
        
        .driver-popover-title {
            color: #667eea !important;
            font-size: 16px !important;
        }
        
        .driver-popover-description {
            color: #ccc !important;
            font-size: 14px !important;
        }
        
        .driver-popover-progress-text {
            color: #888 !important;
        }
        
        .driver-popover-prev-btn,
        .driver-popover-next-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            border: none !important;
            border-radius: 8px !important;
            padding: 8px 16px !important;
            font-weight: 500 !important;
        }
        
        .driver-popover-prev-btn:hover,
        .driver-popover-next-btn:hover {
            opacity: 0.9 !important;
        }
        
        .driver-popover-close-btn {
            color: #888 !important;
        }
        
        .driver-popover-close-btn:hover {
            color: #fff !important;
        }
        
        .driver-popover-arrow-side-left.driver-popover-arrow,
        .driver-popover-arrow-side-right.driver-popover-arrow,
        .driver-popover-arrow-side-top.driver-popover-arrow,
        .driver-popover-arrow-side-bottom.driver-popover-arrow {
            border-color: rgba(102, 126, 234, 0.4) !important;
        }
        
        .welcome-footer {
            padding: 20px 30px 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .dont-show-again {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        .dont-show-again input {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
        }
        
        .dont-show-again span {
            font-size: 13px;
            color: #888;
        }
        
        .welcome-btn {
            width: 100%;
            padding: 14px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .welcome-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        /* Updated Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-content {
            flex: 1;
        }
        
        .header .subtitle {
            color: #667eea;
            font-size: 13px;
            margin-bottom: 4px;
        }
        
        .about-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: #667eea;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-left: 20px;
        }
        
        .about-btn:hover {
            background: rgba(102, 126, 234, 0.4);
            transform: scale(1.05);
        }
        
        /* Graph Hint */
        .graph-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
            z-index: 10;
            opacity: 1;
            transition: opacity 0.5s ease;
        }
        
        .graph-hint.hidden {
            opacity: 0;
        }
        
        .graph-hint p {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 8px;
        }
        
        .graph-hint .arrow {
            font-size: 24px;
            color: rgba(102, 126, 234, 0.6);
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(10px); }
            60% { transform: translateY(5px); }
        }
        
        /* Page Footer */
        .page-footer {
            position: fixed;
            bottom: 0;
            left: 380px;
            right: 0;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.5);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            backdrop-filter: blur(10px);
            z-index: 50;
        }
        
        .page-footer p {
            font-size: 11px;
            color: #666;
        }
        
        .page-footer .about-link {
            font-size: 11px;
            color: #667eea;
            background: none;
            border: none;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .page-footer .about-link:hover {
            color: #8b9cf7;
        }
        
        /* Mobile adjustments for new elements */
        @media (max-width: 900px) {
            .welcome-modal {
                max-width: 100%;
                max-height: 85vh;
                margin: 10px;
            }
            
            .welcome-header {
                padding: 20px 20px 15px;
            }
            
            .welcome-header h2 {
                font-size: 20px;
            }
            
            .welcome-body {
                padding: 20px;
            }
            
            .disclaimer-box {
                max-height: 150px;
            }
            
            .welcome-footer {
                padding: 15px 20px 25px;
            }
            
            .page-footer {
                left: 0;
                bottom: 65px;
                padding: 8px 15px;
            }
            
            .page-footer p {
                font-size: 10px;
            }
            
            .graph-hint p {
                font-size: 14px;
            }
            
            .about-btn {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 480px) {
            .welcome-header h2 {
                font-size: 18px;
            }
            
            .disclaimer-box {
                max-height: 120px;
                padding: 14px;
            }
            
            .disclaimer-box p {
                font-size: 11px;
            }
            
            .instruction-item {
                gap: 10px;
            }
            
            .instruction-icon {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }
            
            .instruction-text {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <p class="subtitle">–ü—Ä–æ–µ–∫—Ç –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</p>
            <h1>üó∫Ô∏è –ö–∞—Ä—Ç–∞ –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</h1>
            <p>–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑: –∫–æ–ª–ª–∏–∑–∏–∏, —Ä—ã—á–∞–≥–∏ –∏ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª–∏</p>
        </div>
        <button class="about-btn" id="about-btn" title="–û –ø—Ä–æ–µ–∫—Ç–µ">?</button>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <div class="legend">
                <h3>–¢–∏–ø—ã —É–∑–ª–æ–≤ (–∏–Ω—Å—Ç–∏—Ç—É—Ç—ã)</h3>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #ef4444;"></div>
                    <span>–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç / –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞—Å—Ç—å</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #3b82f6;"></div>
                    <span>–ö—É—Ä—É–ª—Ç–∞–π / –ø–∞—Ä–ª–∞–º–µ–Ω—Ç</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #f59e0b;"></div>
                    <span>–ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #8b5cf6;"></div>
                    <span>–°—É–¥–µ–±–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #10b981;"></div>
                    <span>–ü—Ä–∞–≤–∞ –∏ —Å–≤–æ–±–æ–¥—ã</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #ec4899;"></div>
                    <span>–ú–µ—Å—Ç–Ω–æ–µ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #06b6d4;"></div>
                    <span>–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –ø—Ä–∞–≤–æ</span>
                </div>
            </div>
            
            <div class="legend">
                <h3>–¢–∏–ø—ã —Å–≤—è–∑–µ–π</h3>
                <div class="legend-item">
                    <div class="legend-line" style="background: #ef4444;"></div>
                    <span><strong>–ö–æ–ª–ª–∏–∑–∏—è</strong> ‚Äî –Ω–æ—Ä–º—ã —Ç—è–Ω—É—Ç –≤ —Ä–∞–∑–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #f59e0b;"></div>
                    <span><strong>–†—ã—á–∞–≥</strong> ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏—Å—Ö–æ–¥–∞–º–∏</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #3b82f6;"></div>
                    <span><strong>–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ</strong> ‚Äî —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º–∞</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #6b7280;"></div>
                    <span><strong>–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å</strong> ‚Äî –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è —Å–≤—è–∑—å</span>
                </div>
            </div>

            <div class="filter-section">
                <h3>–§–∏–ª—å—Ç—Ä —É–∑–ª–æ–≤</h3>
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="president">–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç</button>
                <button class="filter-btn" data-filter="parliament">–ü–∞—Ä–ª–∞–º–µ–Ω—Ç</button>
                <button class="filter-btn" data-filter="government">–ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ</button>
                <button class="filter-btn" data-filter="judiciary">–°—É–¥—ã</button>
                <button class="filter-btn" data-filter="rights">–ü—Ä–∞–≤–∞</button>
            </div>
            
            <div class="stats-panel">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä–∞—Ñ–∞</h3>
                <div class="stat-row">
                    <span>–£–∑–ª–æ–≤ (–Ω–æ—Ä–º):</span>
                    <span class="stat-value" id="node-count">27</span>
                </div>
                <div class="stat-row">
                    <span>–°–≤—è–∑–µ–π (–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤):</span>
                    <span class="stat-value" id="edge-count">24</span>
                </div>
                <div class="stat-row">
                    <span>–ö–æ–ª–ª–∏–∑–∏–π:</span>
                    <span class="stat-value" style="color: #ef4444;">9</span>
                </div>
                <div class="stat-row">
                    <span>–†—ã—á–∞–≥–æ–≤:</span>
                    <span class="stat-value" style="color: #f59e0b;">10</span>
                </div>
                <div class="stat-row">
                    <span>–û—Ö–ª–∞–¥–∏—Ç–µ–ª–µ–π:</span>
                    <span class="stat-value" style="color: #3b82f6;">3</span>
                </div>
            </div>
        </div>
        
        <!-- Highlights Panel -->
        <div class="highlights-panel" id="highlights-panel">
            <button class="highlights-toggle" id="highlights-toggle">
                <span class="toggle-icon">üìã</span>
                <span class="toggle-text">–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</span>
                <span class="toggle-arrow">‚óÄ</span>
            </button>
            
            <div class="highlights-content">
                <div class="mobile-pull-indicator"></div>
                <div class="highlights-header">
                    <h2>üîç –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h2>
                    <p class="highlights-subtitle">–¢–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç —á–∏—Ç–∞—Ç—å</p>
                </div>
                
                <div class="highlight-section collision-section">
                    <div class="section-header">
                        <span class="section-icon">‚ö°</span>
                        <h3>–û—Å—Ç—Ä—ã–µ –∫–æ–ª–ª–∏–∑–∏–∏</h3>
                        <span class="section-badge collision-badge">–ù–æ—Ä–º—ã –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É</span>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A60_4,A60_7,A61">
                        <div class="card-number">1</div>
                        <div class="card-content">
                            <h4>¬´–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω—ã¬ª vs –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞</h4>
                            <p><strong>–°—Ç. 60.4 + 60.7 ‚Üî –°—Ç. 61.5</strong></p>
                            <p>–ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 3 —á—Ç–µ–Ω–∏—è –¥–ª—è –∑–∞–∫–æ–Ω–æ–≤, –Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç:</p>
                            <ul>
                                <li>–ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤—É ‚Äî –ø—Ä–∏–Ω–∏–º–∞—Ç—å ¬´–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ù–ü–ê —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞¬ª –ø—Ä–∏ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏</li>
                                <li>–ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–∫–æ–Ω–∞ –±–µ–∑ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –≤–æ–ø—Ä–æ—Å–µ –¥–æ–≤–µ—Ä–∏—è (–∞–Ω–∞–ª–æ–≥ —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–æ–≥–æ 49.3)</li>
                            </ul>
                            <p class="card-impact">üí• <strong>–†–∏—Å–∫:</strong> –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª –∑–∞–∫–æ–Ω–æ—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ –≤ –æ–±—Ö–æ–¥ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—Å–∫–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A5_6,A76_4">
                        <div class="card-number">2</div>
                        <div class="card-content">
                            <h4>–°–ø–µ—Ü—Ä–µ–∂–∏–º—ã vs –∑–∞–ø—Ä–µ—Ç —Å–ø–µ—Ü—Å—É–¥–æ–≤</h4>
                            <p><strong>–°—Ç. 5.6 ‚Üî –°—Ç. 76.4</strong></p>
                            <p>–ó–∞–ø—Ä–µ—â–µ–Ω—ã ¬´—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω—ã–µ —Å—É–¥—ã¬ª, –Ω–æ —Å–ø–µ—Ü—Ä–µ–∂–∏–º—ã –º–æ–≥—É—Ç –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å ¬´–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É–¥–µ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã¬ª.</p>
                            <p class="card-impact">üí• <strong>–†–∏—Å–∫:</strong> –°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–∞–∑–∏-—Å—É–¥–æ–≤ —Å —Å—É–¥–µ–±–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –Ω–µ –Ω–∞—Ä—É—à–∞—é—â–∏—Ö –∑–∞–ø—Ä–µ—Ç</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A41,A23,A35">
                        <div class="card-number">3</div>
                        <div class="card-content">
                            <h4>¬´–°–ø–æ—Å–æ–±–Ω—ã–µ –Ω–∞—Ä—É—à–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ¬ª vs —Å–≤–æ–±–æ–¥—ã</h4>
                            <p><strong>–°—Ç. 41.2 ‚Üî –°—Ç. 23, 35</strong></p>
                            <p>–ù–µ–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã <em>–ª—é–±—ã–µ</em> –¥–µ–π—Å—Ç–≤–∏—è, <em>—Å–ø–æ—Å–æ–±–Ω—ã–µ</em> –Ω–∞—Ä—É—à–∏—Ç—å –º–µ–∂—ç—Ç–Ω–∏—á–µ—Å–∫–æ–µ/–º–µ–∂–∫–æ–Ω—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ.</p>
                            <p class="card-impact">üí• <strong>–†–∏—Å–∫:</strong> –†–∞–∑–º—ã—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Å–≤–æ–±–æ–¥—É —Å–ª–æ–≤–∞ –∏ —Å–æ–±—Ä–∞–Ω–∏–π ¬´–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π¬ª</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A10,A5_3,A75_3">
                        <div class="card-number">4</div>
                        <div class="card-content">
                            <h4>–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –ø—Ä–∞–≤–æ vs —Å—É–≤–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç–æ–ø-–∫—Ä–∞–Ω</h4>
                            <p><strong>–°—Ç. 10 ‚Üî –°—Ç. 5.3 + –°—Ç. 75.3</strong></p>
                            <p>–î–µ–∫–ª–∞—Ä–∏—Ä—É–µ—Ç—Å—è —É–≤–∞–∂–µ–Ω–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∞, –Ω–æ:</p>
                            <ul>
                                <li>–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –∑–∞–∫–æ–Ω–∞–º–∏</li>
                                <li>–ö–° –º–æ–∂–µ—Ç –ø—Ä–∏–∑–Ω–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –Ω–µ –ø–æ–¥–ª–µ–∂–∞—â–∏–º–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é</li>
                            </ul>
                            <p class="card-impact">üí• <strong>–†–∏—Å–∫:</strong> –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤</p>
                        </div>
                    </div>
                </div>
                
                <div class="highlight-section lever-section">
                    <div class="section-header">
                        <span class="section-icon">üéõÔ∏è</span>
                        <h3>–ö–ª—é—á–µ–≤—ã–µ —Ä—ã—á–∞–≥–∏</h3>
                        <span class="section-badge lever-badge">–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏—Å—Ö–æ–¥–∞–º–∏</span>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A46,A57,A62">
                        <div class="card-number">1</div>
                        <div class="card-content">
                            <h4>–°–æ–≥–ª–∞—Å–∏–µ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç–∞ = —Ç—Ä–∏–≥–≥–µ—Ä –µ–≥–æ —Ä–∞—Å–ø—É—Å–∫–∞</h4>
                            <p><strong>–°—Ç. 46, 57 ‚Üí –°—Ç. 62</strong></p>
                            <p>–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –≤–Ω–æ—Å–∏—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç—É—Ä—ã –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –æ—Ç–∫–∞–∑ –ö—É—Ä—É–ª—Ç–∞—è ‚Üí —Ä–∞—Å–ø—É—Å–∫ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç–∞. –≠—Ç–æ –Ω–µ –±–∞–ª–∞–Ω—Å, –∞ –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –≤ —Ä—É–∫–∞—Ö —Ç–æ–≥–æ, –∫—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç.</p>
                            <p class="card-impact">üéØ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –ü–∞—Ä–ª–∞–º–µ–Ω—Ç –≤—ã–Ω—É–∂–¥–µ–Ω —Å–æ–≥–ª–∞—à–∞—Ç—å—Å—è –∏–ª–∏ —Ä–∏—Å–∫–æ–≤–∞—Ç—å —Ä–æ—Å–ø—É—Å–∫–æ–º</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A62,A47">
                        <div class="card-number">2</div>
                        <div class="card-content">
                            <h4>–†–∞—Å–ø—É—Å–∫ ‚Üí –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–æ–µ –Ω–æ—Ä–º–æ—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ</h4>
                            <p><strong>–°—Ç. 62 ‚Üí –°—Ç. 47.2</strong></p>
                            <p>–ü—Ä–∏ ¬´–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏¬ª –ö—É—Ä—É–ª—Ç–∞—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –∏–∑–¥–∞—ë—Ç —É–∫–∞–∑—ã —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞/–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞–∫–æ–Ω–æ–≤. <strong>–ù–µ—Ç —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.</strong></p>
                            <p class="card-impact">üéØ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –ü–µ—Ä–∏–æ–¥ –ø–æ—Å–ª–µ —Ä–∞—Å–ø—É—Å–∫–∞ = –æ–∫–Ω–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –∑–∞–∫–æ–Ω–æ—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A56_2,A58">
                        <div class="card-number">3</div>
                        <div class="card-content">
                            <h4>–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π —Ä—ã—á–∞–≥</h4>
                            <p><strong>–°—Ç. 56.2 + –°—Ç. 58.4</strong></p>
                            <p>–ï—Å–ª–∏ –ö—É—Ä—É–ª—Ç–∞–π –Ω–µ –ø—Ä–µ–æ–¥–æ–ª–µ–ª –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –∑–∞ –º–µ—Å—è—Ü ‚Äî –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–Ω—è—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü—Ä–∏ —ç—Ç–æ–º —Å–æ–∑—ã–≤ –≤–Ω–µ–æ—á–µ—Ä–µ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏: –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç ¬´–º–æ–∂–µ—Ç¬ª, –∞ –Ω–µ ¬´–æ–±—è–∑–∞–Ω¬ª (–¥–∞–∂–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É 1/3 –¥–µ–ø—É—Ç–∞—Ç–æ–≤).</p>
                            <p class="card-impact">üéØ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –º–æ–∂–µ—Ç ¬´–∏–≥—Ä–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º¬ª, –±–ª–æ–∫–∏—Ä—É—è –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–ª–∞–º–µ–Ω—Ç–∞ –≤–æ –≤—Ä–µ–º—è –∫–∞–Ω–∏–∫—É–ª</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A56_16,A69">
                        <div class="card-number">4</div>
                        <div class="card-content">
                            <h4>–í–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è –±–µ–∑ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π</h4>
                            <p><strong>–°—Ç. 56.13/16 ‚Üí –°—Ç. 69</strong></p>
                            <p>–ü–∞—Ä–ª–∞–º–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã—Ä–∞–∑–∏—Ç—å –≤–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤—É. –ù–æ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –≤ 10-–¥–Ω–µ–≤–Ω—ã–π —Å—Ä–æ–∫ —Ä–µ—à–∞–µ—Ç: –ø—Ä–∏–Ω—è—Ç—å –æ—Ç—Å—Ç–∞–≤–∫—É –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∏ –ø–æ—Ä—É—á–∏—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É.</p>
                            <p class="card-impact">üéØ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –ü–∞—Ä–ª–∞–º–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–æ–º–∏–Ω–∞–ª–µ–Ω ‚Äî –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –∑–∞ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–º</p>
                        </div>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A88_5,A89,A91">
                        <div class="card-number">5</div>
                        <div class="card-content">
                            <h4>–ú–µ—Å—Ç–Ω–æ–µ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥ –≤–µ—Ä—Ç–∏–∫–∞–ª—å—é</h4>
                            <p><strong>–°—Ç. 88.5, 89 ‚Üí –°—Ç. 91</strong></p>
                            <p>–°–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ¬´–ø—Ä–∏–∑–Ω–∞—ë—Ç—Å—è –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è¬ª, –Ω–æ:</p>
                            <ul>
                                <li>–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –º–æ–∂–µ—Ç –¥–æ—Å—Ä–æ—á–Ω–æ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –ø–æ–ª–Ω–æ–º–æ—á–∏—è –º–∞—Å–ª–∏—Ö–∞—Ç–∞</li>
                                <li>–ê–∫–∏–º ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞, –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è/—É–≤–æ–ª—å–Ω—è–µ—Ç—Å—è ¬´–ø–æ —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é¬ª</li>
                                <li>–ü—Ä–æ–µ–∫—Ç—ã —Ä–µ—à–µ–Ω–∏–π —Å –≤–ª–∏—è–Ω–∏–µ–º –Ω–∞ –±—é–¥–∂–µ—Ç ‚Äî —Ç–æ–ª—å–∫–æ —Å —Å–æ–≥–ª–∞—Å–∏—è –∞–∫–∏–º–∞</li>
                            </ul>
                            <p class="card-impact">üéØ <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –ê–≤—Ç–æ–Ω–æ–º–∏—è –Ω–∞ –±—É–º–∞–≥–µ, –≤–µ—Ä—Ç–∏–∫–∞–ª—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ</p>
                        </div>
                    </div>
                </div>
                
                <div class="highlight-section cooling-section">
                    <div class="section-header">
                        <span class="section-icon">üßä</span>
                        <h3>–û—Ö–ª–∞–¥–∏—Ç–µ–ª–∏</h3>
                        <span class="section-badge cooling-badge">–î–µ–ª–∞—é—Ç –º–µ—Ö–∞–Ω–∏–∑–º —Ç–æ–∫—Å–∏—á–Ω—ã–º</span>
                    </div>
                    
                    <div class="highlight-card clickable" data-nodes="A50,A46,A62">
                        <div class="card-number">1</div>
                        <div class="card-content">
                            <h4>–ò–º–ø–∏—á–º–µ–Ω—Ç –∫–∞–∫ –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–∞–º–æ—É–±–∏–π—Å—Ç–≤–æ</h4>
                            <p><strong>–°—Ç. 50.3-4</strong></p>
                            <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π <em>chilling effect</em>:</p>
                            <ul>
                                <li>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ –≥–æ—Å–∏–∑–º–µ–Ω—É (–∫—Ä–∞–π–Ω–µ —É–∑–∫–∏–π –ø–æ—Ä–æ–≥)</li>
                                <li><strong>–ï—Å–ª–∏ –æ–±–≤–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ ‚Äî –¥–µ–ø—É—Ç–∞—Ç—ã-–∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä—ã —Ç–µ—Ä—è—é—Ç –º–∞–Ω–¥–∞—Ç</strong></li>
                                <li>–ù–µ–ª—å–∑—è –≤—ã–¥–≤–∏–≥–∞—Ç—å, –ø–æ–∫–∞ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å –æ —Ä–æ—Å–ø—É—Å–∫–µ</li>
                            </ul>
                            <p class="card-impact">üßä <strong>–≠—Ñ—Ñ–µ–∫—Ç:</strong> –†–∏—Å–∫ —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫ ‚Üí –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ—á—Ç–∏ –º—ë—Ä—Ç–≤. –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –º–æ–∂–µ—Ç ¬´–ø–æ–≤–µ—Å–∏—Ç—å¬ª –ø—Ä–æ—Ü–µ—Å—Å —Ä–æ—Å–ø—É—Å–∫–∞ –∫–∞–∫ —â–∏—Ç –æ—Ç –∏–º–ø–∏—á–º–µ–Ω—Ç–∞.</p>
                        </div>
                    </div>
                </div>
                
                <div class="highlight-section recommendations-section">
                    <div class="section-header">
                        <span class="section-icon">üîß</span>
                        <h3>–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è –±–∞–ª–∞–Ω—Å–∞</h3>
                        <span class="section-badge rec-badge">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</span>
                    </div>
                    
                    <div class="rec-list">
                        <div class="rec-item">
                            <span class="rec-number">1</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 47.2:</strong> –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —É–∫–∞–∑–æ–≤ + –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ö—É—Ä—É–ª—Ç–∞–µ–º, –∏–Ω–∞—á–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–µ.
                            </div>
                        </div>
                        <div class="rec-item">
                            <span class="rec-number">2</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 60.4:</strong> –ñ—ë—Å—Ç–∫–∏–π —Ç–∞–π–º–µ—Ä –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ù–ü–ê –∏ –∑–∞–ø—Ä–µ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è –±–µ–∑ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—Å–∫–æ–≥–æ –∞–∫—Ç–∞.
                            </div>
                        </div>
                        <div class="rec-item">
                            <span class="rec-number">3</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 58.4:</strong> –ó–∞–º–µ–Ω–∏—Ç—å ¬´–º–æ–∂–µ—Ç —Å–æ–∑–≤–∞—Ç—å¬ª –Ω–∞ ¬´–æ–±—è–∑–∞–Ω —Å–æ–∑–≤–∞—Ç—å¬ª –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ 1/3 –¥–µ–ø—É—Ç–∞—Ç–æ–≤.
                            </div>
                        </div>
                        <div class="rec-item">
                            <span class="rec-number">4</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 56.2:</strong> –£–±—Ä–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π, –µ—Å–ª–∏ –ö—É—Ä—É–ª—Ç–∞–π –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ –Ω–µ –º–æ–≥ —Å–æ–±—Ä–∞—Ç—å—Å—è.
                            </div>
                        </div>
                        <div class="rec-item">
                            <span class="rec-number">5</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 50.3:</strong> –£–±—Ä–∞—Ç—å –∏–ª–∏ —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ —Å–º—è–≥—á–∏—Ç—å —Å–∞–Ω–∫—Ü–∏—é –¥–ª—è –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–æ–≤ –∏–º–ø–∏—á–º–µ–Ω—Ç–∞ ‚Äî —ç—Ç–æ —è–¥—Ä–æ ¬´–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è¬ª.
                            </div>
                        </div>
                        <div class="rec-item">
                            <span class="rec-number">6</span>
                            <div class="rec-content">
                                <strong>–°—Ç. 41.2:</strong> –°—É–∑–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É ¬´—Å–ø–æ—Å–æ–±–Ω—ã–µ –Ω–∞—Ä—É—à–∏—Ç—å¬ª –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏/—Å–æ—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="graph-container">
            <svg id="graph"></svg>
            <div class="tooltip" id="tooltip"></div>
            <div class="graph-hint" id="graph-hint">
                <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π —É–∑–µ–ª<br>–¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å–≤—è–∑–µ–π</p>
                <div class="arrow">‚Üì</div>
            </div>
            <div class="controls">
                <button class="control-btn" id="zoom-in" title="–ü—Ä–∏–±–ª–∏–∑–∏—Ç—å">+</button>
                <button class="control-btn" id="zoom-out" title="–û—Ç–¥–∞–ª–∏—Ç—å">‚àí</button>
                <button class="control-btn" id="reset" title="–°–±—Ä–æ—Å–∏—Ç—å">‚ü≤</button>
            </div>
        </div>
    </div>
    
    <!-- Mobile Navigation -->
    <div class="mobile-overlay" id="mobile-overlay"></div>
    <button class="mobile-sidebar-toggle" id="mobile-sidebar-toggle">‚ò∞</button>
    
    <nav class="mobile-nav">
        <div class="mobile-nav-tabs">
            <button class="mobile-nav-tab active" data-view="graph">
                <span class="mobile-nav-tab-icon">üó∫Ô∏è</span>
                <span>–ì—Ä–∞—Ñ</span>
            </button>
            <button class="mobile-nav-tab" data-view="highlights" id="mobile-highlights-tab">
                <span class="mobile-nav-tab-icon">üìã</span>
                <span>–í—ã–≤–æ–¥—ã</span>
            </button>
            <button class="mobile-nav-tab" data-view="legend">
                <span class="mobile-nav-tab-icon">‚ÑπÔ∏è</span>
                <span>–õ–µ–≥–µ–Ω–¥–∞</span>
            </button>
        </div>
    </nav>
    
    <!-- Page Footer -->
    <footer class="page-footer">
        <p>–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–∞–≤–æ–≤–æ–≥–æ –ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏—è</p>
        <button class="about-link" id="footer-about-link">–û –ø—Ä–æ–µ–∫—Ç–µ</button>
    </footer>
    
    <!-- Welcome Modal -->
    <div class="welcome-overlay" id="welcome-overlay">
        <div class="welcome-modal">
            <div class="welcome-header">
                <h2>–ö–∞—Ä—Ç–∞ –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤</h2>
                <p>–ü—Ä–æ–µ–∫—Ç –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</p>
            </div>
            <div class="welcome-body">
                <div class="disclaimer-box">
                    <p>–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –ª–∏—á–Ω—É—é –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É, —Å–æ–∑–¥–∞–Ω–Ω—É—é —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ü–µ–ª—å—é ‚Äî –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ —à–∏—Ä–æ–∫–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–æ–≤–æ–π –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω. –ê–≤—Ç–æ—Ä —Å—Ç—Ä–µ–º–∏—Ç—Å—è –≤–Ω–µ—Å—Ç–∏ —Å–≤–æ–π –≤–∫–ª–∞–¥ –≤ –ø—Ä–∞–≤–æ–≤–æ–µ –ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏–µ –≥—Ä–∞–∂–¥–∞–Ω, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É—è—Å—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –ø–∞—Ç—Ä–∏–æ—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–æ—Ç–∏–≤–∞–º–∏ –∏ —É–≤–∞–∂–µ–Ω–∏–µ–º –∫ –û—Å–Ω–æ–≤–Ω–æ–º—É –∑–∞–∫–æ–Ω—É —Å—Ç—Ä–∞–Ω—ã. –í—Å–µ –ø—É–±–ª–∏–∫—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥–∞—é—Ç—Å—è –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–π, –Ω–µ–ø—Ä–µ–¥–≤–∑—è—Ç–æ–π —Ñ–æ—Ä–º–µ –∏ —Å—Ç—Ä–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω. –ü—Ä–æ–µ–∫—Ç –Ω–µ –ø—Ä–µ—Å–ª–µ–¥—É–µ—Ç –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π, –Ω–µ —Å–≤—è–∑–∞–Ω —Å –∫–∞–∫–æ–π-–ª–∏–±–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–∑—ã–≤–æ–≤ –∫ –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º. –ù–∞–ø—Ä–æ—Ç–∏–≤, –æ–Ω –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–æ–≤–æ–π –∫—É–ª—å—Ç—É—Ä—ã –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ –≤ –¥—É—Ö–µ —É–≤–∞–∂–µ–Ω–∏—è –∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É.</p>
                </div>
                <div class="tour-preview">
                    <p>–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –º—ã –ø–æ–∫–∞–∂–µ–º –≤–∞–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä –ø–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</p>
                </div>
            </div>
            <div class="welcome-footer">
                <label class="dont-show-again">
                    <input type="checkbox" id="dont-show-checkbox">
                    <span>–ë–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å</span>
                </label>
                <button class="welcome-btn" id="welcome-start-btn">–ù–∞—á–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä</button>
            </div>
        </div>
    </div>

    <script>
        // Graph data based on the constitutional conflict map
        const nodes = [
            // President / Executive
            { id: "A46", label: "–°—Ç.46", fullLabel: "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç: –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, —Ä–µ—Ñ–µ—Ä–µ–Ω–¥—É–º, —Ä–∞—Å–ø—É—Å–∫", category: "president", cluster: 1, 
              description: "–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª–Ω–æ–º–æ—á–∏—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –ø–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—é –≥–æ—Å–∞–ø–ø–∞—Ä–∞—Ç–∞ –∏ –∑–∞–ø—É—Å–∫—É –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä" },
            { id: "A47", label: "–°—Ç.47.2", fullLabel: "–£–∫–∞–∑—ã —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ö—É—Ä—É–ª—Ç–∞—è", category: "president", cluster: 1,
              description: "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –º–æ–∂–µ—Ç –∏–∑–¥–∞–≤–∞—Ç—å —É–∫–∞–∑—ã, –∏–º–µ—é—â–∏–µ —Å–∏–ª—É –∑–∞–∫–æ–Ω–æ–≤/–∫–æ–Ω—Å—Ç. –∑–∞–∫–æ–Ω–æ–≤ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç–∞ ‚Äî –±–µ–∑ —á—ë—Ç–∫–æ–≥–æ —Å—Ä–æ–∫–∞/—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è" },
            { id: "A50", label: "–°—Ç.50.3-4", fullLabel: "–ò–º–ø–∏—á–º–µ–Ω—Ç: —Å–∞–Ω–∫—Ü–∏–∏ –∏ —Å—Ç–æ–ø-–º–µ—Ö–∞–Ω–∏–∑–º", category: "president", cluster: 1,
              description: "–ò–º–ø–∏—á–º–µ–Ω—Ç –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –∑–∞ –≥–æ—Å–∏–∑–º–µ–Ω—É. –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä—ã —Ç–µ—Ä—è—é—Ç –º–∞–Ω–¥–∞—Ç –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ. –ù–µ–ª—å–∑—è –≤—ã–¥–≤–∏–≥–∞—Ç—å –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è —Ä–æ—Å–ø—É—Å–∫–∞" },
            
            // Parliament
            { id: "A56", label: "–°—Ç.56", fullLabel: "–ü–æ–ª–Ω–æ–º–æ—á–∏—è –ö—É—Ä—É–ª—Ç–∞—è", category: "parliament", cluster: 2,
              description: "–ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–Ω–æ–º–æ—á–∏—è, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π, –≤–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è, –±—é–¥–∂–µ—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å" },
            { id: "A57", label: "–°—Ç.57", fullLabel: "–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å –ö—É—Ä—É–ª—Ç–∞—è", category: "parliament", cluster: 2,
              description: "–ö–∞–Ω–¥–∏–¥–∞—Ç—É—Ä—É –≤–Ω–æ—Å–∏—Ç –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç. –î–≤–∞ –æ—Ç–∫–∞–∑–∞ –∏–∑–±—Ä–∞—Ç—å = —Ä–∞—Å–ø—É—Å–∫ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç–∞" },
            { id: "A58", label: "–°—Ç.58.4", fullLabel: "–í–Ω–µ–æ—á–µ—Ä–µ–¥–Ω–∞—è —Å–µ—Å—Å–∏—è", category: "parliament", cluster: 2,
              description: "–î–∞–∂–µ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ 1/3 –¥–µ–ø—É—Ç–∞—Ç–æ–≤ ‚Äî –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç '–º–æ–∂–µ—Ç', –∞ –Ω–µ '–æ–±—è–∑–∞–Ω' —Å–æ–∑–≤–∞—Ç—å" },
            { id: "A61", label: "–°—Ç.61.5", fullLabel: "–ú–∏–Ω–∏–º—É–º 3 —á—Ç–µ–Ω–∏—è", category: "parliament", cluster: 2,
              description: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ —Ç—Ä—ë—Ö —á—Ç–µ–Ω–∏—è—Ö" },
            { id: "A62", label: "–°—Ç.62", fullLabel: "–†–∞—Å–ø—É—Å–∫ –ö—É—Ä—É–ª—Ç–∞—è", category: "parliament", cluster: 2,
              description: "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç —Ä–∞—Å–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—Ç–∫–∞–∑–∞—Ö –ø–æ –∫–ª—é—á–µ–≤—ã–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è–º/–≤–æ–ø—Ä–æ—Å–∞–º" },
            
            // Government
            { id: "A60_4", label: "–°—Ç.60.4", fullLabel: "–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ù–ü–ê —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞", category: "government", cluster: 3,
              description: "–ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ –ø—Ä–∏ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∞–∫—Ç—ã —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞ ‚Äî –±–µ–∑ –∂—ë—Å—Ç–∫–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞" },
            { id: "A60_7", label: "–°—Ç.60.7", fullLabel: "–í–æ–ø—Ä–æ—Å –¥–æ–≤–µ—Ä–∏—è = –∑–∞–∫–æ–Ω –±–µ–∑ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è", category: "government", cluster: 3,
              description: "–ú–µ—Ö–∞–Ω–∏–∑–º —Ç–∏–ø–∞ '49.3': –∑–∞–∫–æ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –±–µ–∑ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –≤–æ–ø—Ä–æ—Å–µ –¥–æ–≤–µ—Ä–∏—è (–º–∞–∫—Å. 2 —Ä–∞–∑–∞ –≤ –≥–æ–¥)" },
            { id: "A69", label: "–°—Ç.69", fullLabel: "–û—Ç—Å—Ç–∞–≤–∫–∞ –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞", category: "government", cluster: 3,
              description: "–ü–æ—Å–ª–µ –≤–æ—Ç—É–º–∞ –ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ —É—Ö–æ–¥–∏—Ç, –Ω–æ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –≤ 10 –¥–Ω–µ–π —Ä–µ—à–∞–µ—Ç: –ø—Ä–∏–Ω—è—Ç—å –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∏ –ø–æ—Ä—É—á–∏—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å" },
            
            // Judiciary
            { id: "A76_4", label: "–°—Ç.76.4", fullLabel: "–ó–∞–ø—Ä–µ—Ç —Å–ø–µ—Ü/—á—Ä–µ–∑ —Å—É–¥–æ–≤", category: "judiciary", cluster: 4,
              description: "–ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∏ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω—ã—Ö —Å—É–¥–æ–≤" },
            { id: "A78_80", label: "–°—Ç.78+80", fullLabel: "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—É–¥—å–∏ + —Å–æ–≥–ª–∞—Å–∏–µ", category: "judiciary", cluster: 4,
              description: "–°—É–¥—å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º, –Ω–æ –∑–∞–¥–µ—Ä–∂–∞–Ω–∏–µ/–ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å —Å–æ–≥–ª–∞—Å–∏—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ (—á–µ—Ä–µ–∑ –í–°–°) –∏–ª–∏ –ö—É—Ä—É–ª—Ç–∞—è" },
            { id: "A84", label: "–°—Ç.84.2", fullLabel: "–ü—Ä–æ–∫—É—Ä–∞—Ç—É—Ä–∞ –ø–æ–¥–æ—Ç—á—ë—Ç–Ω–∞ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—É", category: "judiciary", cluster: 4,
              description: "'–ù–µ–∑–∞–≤–∏—Å–∏–º–∞ –æ—Ç –¥—Ä—É–≥–∏—Ö –æ—Ä–≥–∞–Ω–æ–≤' –Ω–æ '–ø–æ–¥–æ—Ç—á—ë—Ç–Ω–∞ –ª–∏—à—å –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—É' ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ" },
            { id: "A75_3", label: "–°—Ç.75.3", fullLabel: "–ù–µ–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –º–µ–∂–æ—Ä–≥–∞–Ω–æ–≤", category: "judiciary", cluster: 4,
              description: "–ö–° –†–ö –º–æ–∂–µ—Ç –ø—Ä–∏–∑–Ω–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –Ω–µ –ø–æ–¥–ª–µ–∂–∞—â–∏–º–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é" },
            
            // Rights and Freedoms
            { id: "A41", label: "–°—Ç.41.2", fullLabel: "'–°–ø–æ—Å–æ–±–Ω—ã–µ –Ω–∞—Ä—É—à–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ'", category: "rights", cluster: 5,
              description: "–ù–µ–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω—ã –õ–Æ–ë–´–ï –¥–µ–π—Å—Ç–≤–∏—è, –°–ü–û–°–û–ë–ù–´–ï –Ω–∞—Ä—É—à–∏—Ç—å –º–µ–∂—ç—Ç–Ω–∏—á–µ—Å–∫–æ–µ/–º–µ–∂–∫–æ–Ω—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ ‚Äî —Ä–∞–∑–º—ã—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞" },
            { id: "A23", label: "–°—Ç.23", fullLabel: "–°–≤–æ–±–æ–¥–∞ —Å–ª–æ–≤–∞", category: "rights", cluster: 5,
              description: "–°–≤–æ–±–æ–¥–∞ —Å–ª–æ–≤–∞ + –∑–∞–ø—Ä–µ—Ç —Ü–µ–Ω–∑—É—Ä—ã, –Ω–æ —Å —à–∏—Ä–æ–∫–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—è–º–∏ (–ø–æ—Ä—è–¥–æ–∫, –Ω—Ä–∞–≤—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –∑–¥–æ—Ä–æ–≤—å–µ, —Å–µ–∫—Ä–µ—Ç—ã)" },
            { id: "A35", label: "–°—Ç.35", fullLabel: "–ú–∏—Ä–Ω—ã–µ —Å–æ–±—Ä–∞–Ω–∏—è", category: "rights", cluster: 5,
              description: "–†–∞–∑—Ä–µ—à–µ–Ω—ã, –Ω–æ –º–æ–≥—É—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å—Å—è –∑–∞–∫–æ–Ω–æ–º –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º" },
            { id: "A5_6", label: "–°—Ç.5.6", fullLabel: "–°–ø–µ—Ü—Ä–µ–∂–∏–º—ã –º–µ–Ω—è—é—Ç —Å—É–¥. —Å–∏—Å—Ç–µ–º—É", category: "rights", cluster: 5,
              description: "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã –º–æ–≥—É—Ç –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É–¥–µ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã" },
            
            // Local Self-Government
            { id: "A91", label: "–°—Ç.91", fullLabel: "–ú–µ—Å—Ç–Ω–æ–µ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", category: "local", cluster: 6,
              description: "–ü—Ä–∏–∑–Ω–∞—ë—Ç—Å—è –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–æ–ª–Ω–æ–º–æ—á–∏–π" },
            { id: "A88_5", label: "–°—Ç.88.5", fullLabel: "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –º–∞—Å–ª–∏—Ö–∞—Ç", category: "local", cluster: 6,
              description: "–ü–æ–ª–Ω–æ–º–æ—á–∏—è –º–∞—Å–ª–∏—Ö–∞—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ—Å—Ä–æ—á–Ω–æ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω—ã –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–º (–ø–æ—Å–ª–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π)" },
            { id: "A89", label: "–°—Ç.89", fullLabel: "–ê–∫–∏–º = –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞", category: "local", cluster: 6,
              description: "–ê–∫–∏–º –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–º, –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–æ–ª–µ–Ω '–ø–æ —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é'. –í–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è ‚Äî –ª–∏—à—å –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞" },
            
            // International Law
            { id: "A10", label: "–°—Ç.10", fullLabel: "–£–≤–∞–∂–µ–Ω–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∞", category: "international", cluster: 7,
              description: "–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è —É–≤–∞–∂–µ–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∏ –Ω–æ—Ä–º –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∞" },
            { id: "A5_3", label: "–°—Ç.5.3", fullLabel: "–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤", category: "international", cluster: 7,
              description: "–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–∞–º–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–º)" },
            { id: "A92", label: "–°—Ç.92-93", fullLabel: "–ö–æ–Ω—Å—Ç. –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–µ–Ω–¥—É–º", category: "president", cluster: 1,
              description: "–ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–µ–Ω–¥—É–º –ø–æ —Ä–µ—à–µ–Ω–∏—é –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ + —Ñ–∏–ª—å—Ç—Ä –∑–∞–∫–ª—é—á–µ–Ω–∏—è –ö–° –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏—è–º" },
            
            // Additional nodes for completeness
            { id: "A56_2", label: "–°—Ç.56.2", fullLabel: "–ú–µ—Å—è—á–Ω—ã–π —Å—Ä–æ–∫ –Ω–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è", category: "parliament", cluster: 2,
              description: "–ï—Å–ª–∏ –ö—É—Ä—É–ª—Ç–∞–π –Ω–µ —É–ª–æ–∂–∏–ª—Å—è –≤ –º–µ—Å—è—Ü –Ω–∞ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ ‚Äî –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–Ω—è—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏" },
            { id: "A56_16", label: "–°—Ç.56.13/16", fullLabel: "–í–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è", category: "parliament", cluster: 2,
              description: "–ü–∞—Ä–ª–∞–º–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã—Ä–∞–∑–∏—Ç—å –≤–æ—Ç—É–º –Ω–µ–¥–æ–≤–µ—Ä–∏—è; –Ω–µ—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –ø–æ –±—é–¥–∂–µ—Ç—É = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ—Ç—É–º" }
        ];
        
        const links = [
            // Cluster 1: President-Parliament power dynamics
            { source: "A46", target: "A62", type: "lever", label: "–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –æ—Ç–∫–∞–∑ ‚Üí —Ä–∞—Å–ø—É—Å–∫" },
            { source: "A57", target: "A62", type: "lever", label: "2 –æ—Ç–∫–∞–∑–∞ ‚Üí —Ä–∞—Å–ø—É—Å–∫" },
            { source: "A58", target: "A56", type: "lever", label: "—Å–æ–∑—ã–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞" },
            { source: "A62", target: "A47", type: "lever", label: "—Ä–∞—Å–ø—É—Å–∫ ‚Üí —É–∫–∞–∑—ã —Å–∏–ª–æ–π –∑–∞–∫–æ–Ω–∞" },
            
            // Cluster 2: Legislative bypass mechanisms
            { source: "A60_4", target: "A61", type: "collision", label: "–æ–±—Ö–æ–¥ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã" },
            { source: "A60_7", target: "A61", type: "collision", label: "–∑–∞–∫–æ–Ω –±–µ–∑ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è" },
            
            // Cluster 3: Government accountability
            { source: "A56_16", target: "A69", type: "dependency", label: "–≤–æ—Ç—É–º ‚Üí –æ—Ç—Å—Ç–∞–≤–∫–∞" },
            { source: "A69", target: "A56", type: "lever", label: "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç —Ä–µ—à–∞–µ—Ç" },
            
            // Cluster 4: Impeachment cooling
            { source: "A50", target: "A62", type: "cooling", label: "–∏–º–ø–∏—á–º–µ–Ω—Ç —Å—Ç–æ–ø –ø—Ä–∏ —Ä–æ—Å–ø—É—Å–∫–µ" },
            { source: "A50", target: "A46", type: "cooling", label: "—Å–∞–Ω–∫—Ü–∏–∏ –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–∞–º" },
            
            // Cluster 5: Rights vs broad restrictions
            { source: "A41", target: "A23", type: "collision", label: "—à–∏—Ä–æ–∫–∏–π –∑–∞–ø—Ä–µ—Ç" },
            { source: "A41", target: "A35", type: "collision", label: "—à–∏—Ä–æ–∫–∏–π –∑–∞–ø—Ä–µ—Ç" },
            
            // Cluster 6: Judicial independence vs control
            { source: "A5_6", target: "A76_4", type: "collision", label: "—Å–ø–µ—Ü—Ä–µ–∂–∏–º—ã vs –∑–∞–ø—Ä–µ—Ç —Å–ø–µ—Ü—Å—É–¥–æ–≤" },
            { source: "A84", target: "A78_80", type: "collision", label: "–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª—é—á" },
            
            // Cluster 7: International law
            { source: "A10", target: "A5_3", type: "collision", label: "–º–µ–∂–¥—É–Ω–∞—Ä. –Ω–æ—Ä–º—ã vs –≤–Ω—É—Ç—Ä. –ø–æ—Ä—è–¥–æ–∫" },
            { source: "A75_3", target: "A10", type: "lever", label: "—Å—É–≤–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç–æ–ø-–∫—Ä–∞–Ω" },
            
            // Cluster 8: Local self-government
            { source: "A88_5", target: "A91", type: "lever", label: "—Ä–æ—Å–ø—É—Å–∫ –º–∞—Å–ª–∏—Ö–∞—Ç–æ–≤" },
            { source: "A89", target: "A91", type: "lever", label: "–≤–µ—Ä—Ç–∏–∫–∞–ª—å –≤–ª–∞—Å—Ç–∏" },
            
            // Cluster 9: Constitutional changes
            { source: "A46", target: "A92", type: "lever", label: "—Ä–µ—Ñ–µ—Ä–µ–Ω–¥—É–º = —Ä–µ—à–µ–Ω–∏–µ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞" },
            
            // Calendar control
            { source: "A56_2", target: "A58", type: "lever", label: "–∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π —Ä—ã—á–∞–≥" },
            
            // Cross-cluster dependencies
            { source: "A47", target: "A61", type: "collision", label: "—É–∫–∞–∑—ã vs –ø—Ä–æ—Ü–µ–¥—É—Ä–∞" },
            { source: "A56", target: "A46", type: "dependency", label: "—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π" },
            { source: "A69", target: "A46", type: "dependency", label: "–æ—Ç—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞" },
            { source: "A78_80", target: "A46", type: "dependency", label: "—Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ" }
        ];
        
        // Color mappings
        const categoryColors = {
            president: { fill: "#ef4444", stroke: "#dc2626" },
            parliament: { fill: "#3b82f6", stroke: "#2563eb" },
            government: { fill: "#f59e0b", stroke: "#d97706" },
            judiciary: { fill: "#8b5cf6", stroke: "#7c3aed" },
            rights: { fill: "#10b981", stroke: "#059669" },
            local: { fill: "#ec4899", stroke: "#db2777" },
            international: { fill: "#06b6d4", stroke: "#0891b2" }
        };
        
        const linkColors = {
            collision: "#ef4444",
            lever: "#f59e0b",
            cooling: "#3b82f6",
            dependency: "#6b7280"
        };
        
        // SVG setup
        const svg = d3.select("#graph");
        const container = document.querySelector(".graph-container");
        const width = container.clientWidth;
        const height = container.clientHeight;
        
        svg.attr("viewBox", [0, 0, width, height]);
        
        // Create arrow markers for directed edges
        const defs = svg.append("defs");
        
        Object.keys(linkColors).forEach(type => {
            defs.append("marker")
                .attr("id", `arrow-${type}`)
                .attr("viewBox", "0 -5 10 10")
                .attr("refX", 25)
                .attr("refY", 0)
                .attr("markerWidth", 6)
                .attr("markerHeight", 6)
                .attr("orient", "auto")
                .append("path")
                .attr("fill", linkColors[type])
                .attr("d", "M0,-5L10,0L0,5");
        });
        
        // Add glow filter
        const filter = defs.append("filter")
            .attr("id", "glow")
            .attr("x", "-50%")
            .attr("y", "-50%")
            .attr("width", "200%")
            .attr("height", "200%");
        
        filter.append("feGaussianBlur")
            .attr("stdDeviation", "3")
            .attr("result", "coloredBlur");
        
        const feMerge = filter.append("feMerge");
        feMerge.append("feMergeNode").attr("in", "coloredBlur");
        feMerge.append("feMergeNode").attr("in", "SourceGraphic");
        
        // Create zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.3, 3])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });
        
        svg.call(zoom);
        
        // Main group for zooming
        const g = svg.append("g");
        
        // Create force simulation
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(150))
            .force("charge", d3.forceManyBody().strength(-800))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(50))
            .force("x", d3.forceX(width / 2).strength(0.05))
            .force("y", d3.forceY(height / 2).strength(0.05));
        
        // Create links
        const link = g.append("g")
            .selectAll("path")
            .data(links)
            .join("path")
            .attr("class", d => `link edge-${d.type}`)
            .attr("stroke", d => linkColors[d.type])
            .attr("stroke-width", 2)
            .attr("marker-end", d => `url(#arrow-${d.type})`)
            .attr("fill", "none");
        
        // Create link labels with background
        const linkLabelGroup = g.append("g")
            .attr("class", "link-labels");
        
        const linkLabelItems = linkLabelGroup.selectAll("g")
            .data(links)
            .join("g")
            .attr("class", "link-label-item");
        
        // Background rectangles for labels
        linkLabelItems.append("rect")
            .attr("class", "link-label-bg")
            .attr("height", 16)
            .attr("y", -10);
        
        // Label text
        const linkLabel = linkLabelItems.append("text")
            .attr("class", "link-label")
            .text(d => d.label);
        
        // Calculate and set background width after text is rendered
        linkLabelItems.each(function(d) {
            const text = d3.select(this).select("text");
            const bbox = text.node().getBBox();
            d3.select(this).select("rect")
                .attr("width", bbox.width + 10)
                .attr("x", -bbox.width / 2 - 5);
        });
        
        // Identify peripheral clusters (less crowded areas) - show labels by default
        // These are nodes that are not in the central "president-parliament" cluster
        const peripheralNodes = new Set([
            "A10", "A5_3", "A75_3",           // International law cluster
            "A88_5", "A89", "A91",             // Local government cluster
            "A5_6", "A76_4",                   // Special regimes vs courts
            "A41", "A23", "A35"                // Rights cluster
        ]);
        
        // Show labels for peripheral links by default
        linkLabelItems.each(function(d, i) {
            const sourceId = typeof d.source === 'object' ? d.source.id : d.source;
            const targetId = typeof d.target === 'object' ? d.target.id : d.target;
            
            // If both nodes are peripheral, show label
            if (peripheralNodes.has(sourceId) && peripheralNodes.has(targetId)) {
                d3.select(this).classed("visible", true).classed("peripheral", true);
            }
        });
        
        // Create nodes
        const node = g.append("g")
            .selectAll("g")
            .data(nodes)
            .join("g")
            .attr("class", "node")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));
        
        node.append("circle")
            .attr("r", 22)
            .attr("fill", d => categoryColors[d.category].fill)
            .attr("stroke", d => categoryColors[d.category].stroke)
            .attr("filter", "url(#glow)");
        
        node.append("text")
            .attr("dy", "0.35em")
            .attr("text-anchor", "middle")
            .text(d => d.label);
        
        // Tooltip
        const tooltip = d3.select("#tooltip");
        const graphContainer = document.querySelector(".graph-container");
        
        node.on("mouseover", function(event, d) {
            const containerRect = graphContainer.getBoundingClientRect();
            const mouseX = event.clientX - containerRect.left;
            const mouseY = event.clientY - containerRect.top;
            
            // Calculate position, keeping tooltip inside container
            let tooltipX = mouseX + 20;
            let tooltipY = mouseY - 10;
            
            // Prevent tooltip from going off right edge
            if (tooltipX + 320 > containerRect.width) {
                tooltipX = mouseX - 340;
            }
            
            // Prevent tooltip from going off bottom
            if (tooltipY + 150 > containerRect.height) {
                tooltipY = containerRect.height - 160;
            }
            
            // Prevent tooltip from going off top
            if (tooltipY < 10) {
                tooltipY = 10;
            }
            
            tooltip.style("opacity", 1)
                .html(`<h5>${d.fullLabel}</h5><p>${d.description}</p>`)
                .style("left", tooltipX + "px")
                .style("top", tooltipY + "px");
            
            d3.select(this).select("circle")
                .transition()
                .duration(200)
                .attr("r", 28);
        })
        .on("mousemove", function(event, d) {
            const containerRect = graphContainer.getBoundingClientRect();
            const mouseX = event.clientX - containerRect.left;
            const mouseY = event.clientY - containerRect.top;
            
            let tooltipX = mouseX + 20;
            let tooltipY = mouseY - 10;
            
            if (tooltipX + 320 > containerRect.width) {
                tooltipX = mouseX - 340;
            }
            if (tooltipY + 150 > containerRect.height) {
                tooltipY = containerRect.height - 160;
            }
            if (tooltipY < 10) {
                tooltipY = 10;
            }
            
            tooltip.style("left", tooltipX + "px")
                .style("top", tooltipY + "px");
        })
        .on("mouseout", function() {
            tooltip.style("opacity", 0);
            d3.select(this).select("circle")
                .transition()
                .duration(200)
                .attr("r", 22);
        })
        // Node click/tap handler function
        function handleNodeClick(event, d) {
            event.stopPropagation();
            if (event.preventDefault) event.preventDefault();
            
            // Find all connected nodes (direct neighbors)
            const connectedIds = new Set([d.id]);
            
            links.forEach(link => {
                const sourceId = typeof link.source === 'object' ? link.source.id : link.source;
                const targetId = typeof link.target === 'object' ? link.target.id : link.target;
                
                if (sourceId === d.id) connectedIds.add(targetId);
                if (targetId === d.id) connectedIds.add(sourceId);
            });
            
            // Convert to array
            const nodeIds = Array.from(connectedIds);
            
            // Clear previous and set new highlights
            clearHighlights();
            
            // Highlight nodes
            node.classed("dimmed", n => !nodeIds.includes(n.id));
            node.classed("highlighted", n => nodeIds.includes(n.id));
            
            // Highlight related links and show their labels
            link.each(function(linkData, i) {
                const sourceId = typeof linkData.source === 'object' ? linkData.source.id : linkData.source;
                const targetId = typeof linkData.target === 'object' ? linkData.target.id : linkData.target;
                const isRelated = nodeIds.includes(sourceId) && nodeIds.includes(targetId);
                
                d3.select(this)
                    .classed("dimmed", !isRelated)
                    .classed("highlighted", isRelated);
                
                // Show/hide label
                d3.select(linkLabelItems.nodes()[i]).classed("visible", isRelated);
            });
            
            // Show tooltip on mobile
            if ('ontouchstart' in window) {
                tooltip.style("opacity", 1)
                    .html(`<h5>${d.fullLabel}</h5><p>${d.description}</p>`)
                    .style("left", "50%")
                    .style("top", "auto")
                    .style("bottom", "80px")
                    .style("transform", "translateX(-50%)");
            }
        }
        
        node.on("click", handleNodeClick);
        
        // Touch support for nodes
        let touchTimeout;
        let touchMoved = false;
        
        node.on("touchstart", function(event, d) {
            touchMoved = false;
            touchTimeout = setTimeout(() => {
                // Long press - show tooltip
                if (!touchMoved) {
                    handleNodeClick(event, d);
                }
            }, 200);
        }, { passive: false })
        .on("touchmove", function() {
            touchMoved = true;
            clearTimeout(touchTimeout);
        })
        .on("touchend", function(event, d) {
            clearTimeout(touchTimeout);
            if (!touchMoved) {
                event.preventDefault();
                handleNodeClick(event, d);
            }
        });
        
        // Simulation tick
        simulation.on("tick", () => {
            link.attr("d", d => {
                const dx = d.target.x - d.source.x;
                const dy = d.target.y - d.source.y;
                const dr = Math.sqrt(dx * dx + dy * dy) * 1.5;
                return `M${d.source.x},${d.source.y}A${dr},${dr} 0 0,1 ${d.target.x},${d.target.y}`;
            });
            
            linkLabelItems
                .attr("transform", d => {
                    const midX = (d.source.x + d.target.x) / 2;
                    const midY = (d.source.y + d.target.y) / 2;
                    // Offset perpendicular to the line
                    const dx = d.target.x - d.source.x;
                    const dy = d.target.y - d.source.y;
                    const len = Math.sqrt(dx * dx + dy * dy) || 1;
                    const offsetX = -dy / len * 15;
                    const offsetY = dx / len * 15;
                    return `translate(${midX + offsetX}, ${midY + offsetY})`;
                });
            
            node.attr("transform", d => `translate(${d.x},${d.y})`);
        });
        
        // Link hover - show label
        link.on("mouseover", function(event, d) {
            const index = links.indexOf(d);
            d3.select(linkLabelItems.nodes()[index]).classed("visible", true);
            d3.select(this).attr("stroke-width", 4);
        })
        .on("mouseout", function(event, d) {
            const index = links.indexOf(d);
            // Only hide if not highlighted
            if (!d3.select(this).classed("highlighted")) {
                d3.select(linkLabelItems.nodes()[index]).classed("visible", false);
                d3.select(this).attr("stroke-width", 2);
            }
        });
        
        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }
        
        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }
        
        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }
        
        // Controls
        document.getElementById("zoom-in").addEventListener("click", () => {
            svg.transition().call(zoom.scaleBy, 1.3);
        });
        
        document.getElementById("zoom-out").addEventListener("click", () => {
            svg.transition().call(zoom.scaleBy, 0.7);
        });
        
        document.getElementById("reset").addEventListener("click", () => {
            svg.transition().call(zoom.transform, d3.zoomIdentity);
            simulation.alpha(0.5).restart();
        });
        
        // Filter buttons
        document.querySelectorAll(".filter-btn").forEach(btn => {
            btn.addEventListener("click", function() {
                document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
                this.classList.add("active");
                
                const filter = this.dataset.filter;
                
                node.style("opacity", d => {
                    if (filter === "all") return 1;
                    return d.category === filter ? 1 : 0.2;
                });
                
                link.style("opacity", d => {
                    if (filter === "all") return 0.6;
                    const sourceNode = nodes.find(n => n.id === d.source.id || n.id === d.source);
                    const targetNode = nodes.find(n => n.id === d.target.id || n.id === d.target);
                    return (sourceNode?.category === filter || targetNode?.category === filter) ? 0.8 : 0.1;
                });
            });
        });

        // Update stats
        document.getElementById("node-count").textContent = nodes.length;
        document.getElementById("edge-count").textContent = links.length;
        
        // Highlights panel toggle
        const highlightsPanel = document.getElementById("highlights-panel");
        const highlightsToggle = document.getElementById("highlights-toggle");
        
        highlightsToggle.addEventListener("click", () => {
            highlightsPanel.classList.toggle("open");
        });
        
        // Highlight nodes when clicking on cards
        let activeCard = null;
        
        document.querySelectorAll(".highlight-card.clickable").forEach(card => {
            card.addEventListener("click", function(e) {
                e.stopPropagation();
                
                const nodeIds = this.dataset.nodes.split(",");
                
                // Toggle active state
                if (activeCard === this) {
                    // Deselect
                    clearHighlights();
                    activeCard = null;
                    return;
                }
                
                // Clear previous
                clearHighlights();
                
                // Set new active card
                activeCard = this;
                this.classList.add("active");
                
                // Highlight nodes
                node.classed("dimmed", d => !nodeIds.includes(d.id));
                node.classed("highlighted", d => nodeIds.includes(d.id));
                
                // Highlight related links and show their labels
                link.each(function(d, i) {
                    const sourceId = typeof d.source === 'object' ? d.source.id : d.source;
                    const targetId = typeof d.target === 'object' ? d.target.id : d.target;
                    const isRelated = nodeIds.includes(sourceId) && nodeIds.includes(targetId);
                    
                    d3.select(this)
                        .classed("dimmed", !isRelated)
                        .classed("highlighted", isRelated);
                    
                    // Show/hide label
                    d3.select(linkLabelItems.nodes()[i]).classed("visible", isRelated);
                });
                
                // Center view on highlighted nodes
                const highlightedNodes = nodes.filter(n => nodeIds.includes(n.id));
                if (highlightedNodes.length > 0) {
                    const avgX = highlightedNodes.reduce((sum, n) => sum + n.x, 0) / highlightedNodes.length;
                    const avgY = highlightedNodes.reduce((sum, n) => sum + n.y, 0) / highlightedNodes.length;
                    
                    svg.transition()
                        .duration(750)
                        .call(zoom.transform, d3.zoomIdentity
                            .translate(width / 2, height / 2)
                            .scale(1.2)
                            .translate(-avgX, -avgY));
                }
            });
        });
        
        function clearHighlights() {
            document.querySelectorAll(".highlight-card.active").forEach(c => c.classList.remove("active"));
            node.classed("dimmed", false);
            node.classed("highlighted", false);
            link.classed("dimmed", false);
            link.classed("highlighted", false);
            link.attr("stroke-width", 2);
            // Hide non-peripheral labels, restore peripheral ones
            linkLabelItems.each(function() {
                const isPeripheral = d3.select(this).classed("peripheral");
                d3.select(this).classed("visible", isPeripheral);
            });
        }
        
        // Click on graph background to clear highlights
        svg.on("click", function(e) {
            if (e.target === this || e.target.tagName === 'svg') {
                clearHighlights();
                activeCard = null;
            }
        });
        
        // Also clear when pressing Escape
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") {
                clearHighlights();
                activeCard = null;
                svg.transition().call(zoom.transform, d3.zoomIdentity);
            }
        });
        
        // ============================================
        // MOBILE FUNCTIONALITY
        // ============================================
        
        const sidebar = document.querySelector(".sidebar");
        const mobileOverlay = document.getElementById("mobile-overlay");
        const mobileSidebarToggle = document.getElementById("mobile-sidebar-toggle");
        const mobileNavTabs = document.querySelectorAll(".mobile-nav-tab");
        
        // Mobile sidebar toggle
        mobileSidebarToggle.addEventListener("click", () => {
            sidebar.classList.toggle("open");
            mobileOverlay.classList.toggle("visible");
        });
        
        // Close sidebar when clicking overlay
        mobileOverlay.addEventListener("click", () => {
            sidebar.classList.remove("open");
            mobileOverlay.classList.remove("visible");
        });
        
        // Mobile navigation tabs
        mobileNavTabs.forEach(tab => {
            tab.addEventListener("click", function() {
                const view = this.dataset.view;
                
                // Update active tab
                mobileNavTabs.forEach(t => t.classList.remove("active"));
                this.classList.add("active");
                
                // Handle view switching
                switch(view) {
                    case "graph":
                        highlightsPanel.classList.remove("open");
                        sidebar.classList.remove("open");
                        mobileOverlay.classList.remove("visible");
                        break;
                    case "highlights":
                        highlightsPanel.classList.add("open");
                        sidebar.classList.remove("open");
                        mobileOverlay.classList.remove("visible");
                        break;
                    case "legend":
                        highlightsPanel.classList.remove("open");
                        sidebar.classList.add("open");
                        mobileOverlay.classList.add("visible");
                        break;
                }
            });
        });
        
        // When clicking a card in highlights, switch to graph view on mobile
        document.querySelectorAll(".highlight-card.clickable").forEach(card => {
            card.addEventListener("click", function() {
                // On mobile, switch to graph view after selecting a card
                if (window.innerWidth <= 900) {
                    setTimeout(() => {
                        highlightsPanel.classList.remove("open");
                        mobileNavTabs.forEach(t => t.classList.remove("active"));
                        document.querySelector('[data-view="graph"]').classList.add("active");
                    }, 300);
                }
            });
        });
        
        // Touch support for better mobile interaction
        let touchStartY = 0;
        const highlightsContent = document.querySelector(".highlights-content");
        
        highlightsContent.addEventListener("touchstart", (e) => {
            touchStartY = e.touches[0].clientY;
        }, { passive: true });
        
        highlightsContent.addEventListener("touchmove", (e) => {
            // If at top of scroll and pulling down, allow swipe to close
            if (highlightsContent.scrollTop === 0) {
                const touchY = e.touches[0].clientY;
                const diff = touchY - touchStartY;
                
                if (diff > 100) {
                    highlightsPanel.classList.remove("open");
                    mobileNavTabs.forEach(t => t.classList.remove("active"));
                    document.querySelector('[data-view="graph"]').classList.add("active");
                }
            }
        }, { passive: true });
        
        // Resize handler to fix layout on orientation change
        window.addEventListener("resize", () => {
            // Update SVG viewBox
            const newWidth = container.clientWidth;
            const newHeight = container.clientHeight;
            svg.attr("viewBox", [0, 0, newWidth, newHeight]);
            
            // Re-center simulation
            simulation.force("center", d3.forceCenter(newWidth / 2, newHeight / 2));
            simulation.alpha(0.3).restart();
        });
        
        // ============================================
        // WELCOME MODAL & ONBOARDING
        // ============================================
        
        const welcomeOverlay = document.getElementById("welcome-overlay");
        const welcomeStartBtn = document.getElementById("welcome-start-btn");
        const dontShowCheckbox = document.getElementById("dont-show-checkbox");
        const aboutBtn = document.getElementById("about-btn");
        const footerAboutLink = document.getElementById("footer-about-link");
        const graphHint = document.getElementById("graph-hint");
        
        const STORAGE_KEY = "kz-constitution-hide-welcome";
        
        // Check if should show welcome modal
        function shouldShowWelcome() {
            try {
                return localStorage.getItem(STORAGE_KEY) !== "true";
            } catch (e) {
                return true; // Show by default if localStorage unavailable
            }
        }
        
        // Show welcome modal
        function showWelcome() {
            welcomeOverlay.classList.remove("hidden");
        }
        
        // Hide welcome modal
        function hideWelcome() {
            welcomeOverlay.classList.add("hidden");
            
            // Save preference if checkbox is checked
            if (dontShowCheckbox.checked) {
                try {
                    localStorage.setItem(STORAGE_KEY, "true");
                } catch (e) {
                    console.log("localStorage not available");
                }
            }
        }
        
        // Hide graph hint
        function hideGraphHint() {
            graphHint.classList.add("hidden");
        }
        
        // Initialize welcome modal
        if (shouldShowWelcome()) {
            showWelcome();
        } else {
            welcomeOverlay.classList.add("hidden");
        }
        
        // Event listeners
        welcomeStartBtn.addEventListener("click", hideWelcome);
        
        aboutBtn.addEventListener("click", () => {
            dontShowCheckbox.checked = false; // Reset checkbox when opening manually
            showWelcome();
        });
        
        footerAboutLink.addEventListener("click", () => {
            dontShowCheckbox.checked = false;
            showWelcome();
        });
        
        // Close modal on overlay click (outside modal)
        welcomeOverlay.addEventListener("click", (e) => {
            if (e.target === welcomeOverlay) {
                hideWelcome();
            }
        });
        
        // Close modal on Escape key
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape" && !welcomeOverlay.classList.contains("hidden")) {
                hideWelcome();
            }
        });
        
        // Hide graph hint on first interaction
        let hintHidden = false;
        
        function hideHintOnInteraction() {
            if (!hintHidden) {
                hideGraphHint();
                hintHidden = true;
            }
        }
        
        // Listen for graph interactions to hide hint
        svg.on("click.hint", hideHintOnInteraction);
        svg.on("touchstart.hint", hideHintOnInteraction);
        node.on("click.hint", hideHintOnInteraction);
        node.on("touchstart.hint", hideHintOnInteraction);
        
        // ============================================
        // INTERACTIVE TOUR (driver.js)
        // ============================================
        
        const driverObj = window.driver.js.driver;
        
        function startTour() {
            // Hide graph hint before tour starts
            hideHintOnInteraction();
            
            // Determine if mobile
            const isMobile = window.innerWidth <= 900;
            
            // Get the first visible node for targeting
            const firstNode = document.querySelector('.node');
            
            // Create tour with interactive first step
            let tour;
            
            const tourSteps = [
                {
                    element: firstNode || '#graph',
                    popover: {
                        title: '–®–∞–≥ 1: –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —É–∑–µ–ª',
                        description: '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∂–∞—Ç—å –Ω–∞ —ç—Ç–æ—Ç —É–∑–µ–ª –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ "–î–∞–ª–µ–µ" —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.',
                        side: 'bottom',
                        align: 'center',
                        onNextClick: () => {
                            // Simulate click on the node to show the effect
                            if (firstNode) {
                                const nodeData = d3.select(firstNode).datum();
                                if (nodeData) {
                                    handleNodeClick({ stopPropagation: () => {}, preventDefault: () => {} }, nodeData);
                                }
                            }
                            tour.moveNext();
                        }
                    }
                },
                {
                    element: '.graph-container',
                    popover: {
                        title: '–†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–≤—è–∑–∏ –≤–∏–¥–Ω—ã!',
                        description: '–¢–µ–ø–µ—Ä—å –≤—ã –≤–∏–¥–∏—Ç–µ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ ‚Äî –æ–Ω–∏ –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞—Ç–µ–º–Ω–µ–Ω—ã. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ –≥—Ä–∞—Ñ–∞, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å.',
                        side: 'left',
                        align: 'center',
                        onPrevClick: () => {
                            clearHighlights();
                            tour.movePrevious();
                        }
                    }
                },
                {
                    element: '#graph',
                    popover: {
                        title: '–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥—Ä–∞—Ñ—É',
                        description: isMobile 
                            ? '–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –≥—Ä–∞—Ñ –ø–∞–ª—å—Ü–µ–º –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤–∞ –ø–∞–ª—å—Ü–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.' 
                            : '–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –≥—Ä–∞—Ñ –º—ã—à—å—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ª—ë—Å–∏–∫–æ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.',
                        side: 'top',
                        align: 'center',
                        onPrevClick: () => {
                            clearHighlights();
                            tour.movePrevious();
                        }
                    }
                },
                {
                    element: isMobile ? '#mobile-highlights-tab' : '#highlights-toggle',
                    popover: {
                        title: '–¢–µ–∫—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑',
                        description: '–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å ¬´–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã¬ª –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, —Ä—ã—á–∞–≥–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.',
                        side: isMobile ? 'top' : 'left',
                        align: 'center'
                    }
                },
                {
                    element: '#about-btn',
                    popover: {
                        title: '–°–ø—Ä–∞–≤–∫–∞',
                        description: '–ù–∞–∂–º–∏—Ç–µ —ç—Ç—É –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —Å–Ω–æ–≤–∞ —É–≤–∏–¥–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—É—Ä.',
                        side: 'bottom',
                        align: 'end'
                    }
                }
            ];
            
            tour = driverObj({
                showProgress: true,
                progressText: '{{current}} –∏–∑ {{total}}',
                nextBtnText: '–î–∞–ª–µ–µ',
                prevBtnText: '–ù–∞–∑–∞–¥',
                doneBtnText: '–ì–æ—Ç–æ–≤–æ',
                steps: tourSteps,
                onDestroyed: () => {
                    // Clear highlights when tour ends
                    clearHighlights();
                }
            });
            
            // Small delay to ensure modal is fully hidden
            setTimeout(() => {
                tour.drive();
            }, 300);
        }
        
        // Track if tour should start after modal closes
        let shouldStartTour = false;
        
        // Override welcome start button to also trigger tour
        welcomeStartBtn.removeEventListener("click", hideWelcome);
        welcomeStartBtn.addEventListener("click", () => {
            shouldStartTour = true;
            hideWelcome();
            startTour();
        });
    </script>
</body>
</html>
